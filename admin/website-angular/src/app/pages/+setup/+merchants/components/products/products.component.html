<!-- TODO add translate -->
<nb-card class="setup-merchant-products">
	<nb-card-header>
		<span *ngIf="currentView == componentViews.main">
			Products
		</span>
		<span *ngIf="currentView == componentViews.productsTable">
			Select from products catalog
		</span>
		<span *ngIf="currentView == componentViews.createProduct">
			Create product
		</span>
		<span *ngIf="currentView == componentViews.editProduct">
			Edit product
		</span>
		<span *ngIf="currentView == componentViews.addProducts">
			Add product
		</span>
	</nb-card-header>
	<nb-card-body>
		<div
			[hidden]="currentView !== componentViews.main"
			class="main-content"
		>
			<!-- TODO disable if store id don't exist -->
			<div class="row actions">
				<div class="form-group offset-md-2 col-md-4">
					<button
						nbButton
						outline
						status="success"
						(click)="currentView = componentViews.productsTable"
					>
						Select from products catalog
					</button>
				</div>

				<div class="form-group col-md-4">
					<button
						nbButton
						outline
						status="success"
						(click)="currentView = componentViews.createProduct"
					>
						Create new product
					</button>
				</div>

				<div [hidden]="!showProductsTable">
					<ea-warehouse-products-table
						#productsTable
						[selectMode]="null"
						[perPage]="productsPerPage"
						(onEdit)="editProduct($event)"
						(onDelete)="removeProduct($event)"
					></ea-warehouse-products-table>
				</div>
			</div>
		</div>

		<div *ngIf="currentView == componentViews.productsTable" class="row">
			<ea-merchants-setup-products-catalog
				[existedProductsIds]="existedProductsIds"
				#productsCatalog
			></ea-merchants-setup-products-catalog>
		</div>

		<div
			*ngIf="
				currentView == componentViews.createProduct ||
				currentView == componentViews.editProduct
			"
			class="row"
		>
			<div class="form-group offset-md-2 col-md-8">
				<ea-merchants-setup-product-mutation
					(onCreate)="select([$event])"
					(onEdit)="updateMain()"
					[product]="currentProduct"
					#productMutation
				></ea-merchants-setup-product-mutation>
			</div>
		</div>

		<div *ngIf="currentView == componentViews.addProducts" class="row">
			<ea-merchants-setup-add-products
				#addProducts
				[products]="productsForAdd"
				[storeId]="storeId"
				(successAdd)="currentView = componentViews.main"
			></ea-merchants-setup-add-products>
		</div> </nb-card-body
></nb-card>

<div *ngIf="currentView === componentViews.main">
	<button nbButton (click)="previousStep.emit()">
		{{ 'FAKE_DATA.SETUP_MERCHANTS.PREV' | translate }}
	</button>
	<button nbButton (click)="nextStep.emit()">
		{{ 'FAKE_DATA.SETUP_MERCHANTS.NEXT' | translate }}
	</button>
</div>
<div *ngIf="currentView !== componentViews.main">
	<button nbButton (click)="back()">
		{{ 'FAKE_DATA.SETUP_MERCHANTS.BACK' | translate }}
	</button>
	<button
		*ngIf="currentView === componentViews.productsTable"
		[disabled]="!haveProductsForAdd"
		nbButton
		(click)="select(productsCatalog?.productsTable.selectedProducts)"
	>
		Select
	</button>

	<button
		*ngIf="currentView === componentViews.addProducts"
		[disabled]="!addProducts?.addWarehouseProductsTable.productsIsValid()"
		nbButton
		(click)="addProducts.add()"
	>
		Add
	</button>

	<button
		*ngIf="currentView === componentViews.createProduct"
		nbButton
		[disabled]="!productMutation?.basicInfo.valid || false"
		(click)="productMutation.create()"
	>
		Create
	</button>

	<button
		*ngIf="currentView === componentViews.editProduct"
		nbButton
		[disabled]="!productMutation?.basicInfo.valid || false"
		(click)="productMutation.save()"
	>
		Save
	</button>
</div>
